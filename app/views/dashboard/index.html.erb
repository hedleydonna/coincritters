<div class="fixed inset-0 bg-gradient-to-br from-green-50 via-emerald-50 to-amber-50 flex flex-col justify-center px-4" style="top: 0; left: 0; right: 0; bottom: 5rem; overflow: hidden;">
  <div class="w-full max-w-md p-5 mx-auto" style="max-height: 100%; overflow-y: auto;">
    <!-- Welcome Header -->
    <div class="text-center mb-4">
      <div class="mb-3">
        <%= image_tag "willow.png", alt: "Baby Willow", class: "mx-auto h-16 w-16 object-contain" %>
      </div>
      
      <h1 class="text-3xl font-bold text-gray-900">
        Welcome back
      </h1>
      <p class="text-lg text-gray-700 mt-1 font-medium">
        <%= current_user.display_name.presence || current_user.email.split("@").first.capitalize %>!
      </p>
      <p class="text-sm text-gray-600 mt-1">
        Your willow tree is ready to grow!
      </p>
    </div>

    <!-- Money Map Summary -->
    <% if @budget %>
      <div class="space-y-3">
        <div class="text-center mb-4">
          <h2 class="text-2xl font-bold text-gray-900 mb-1">
            Money Map
          </h2>
          <p class="text-sm text-gray-600">
            <%= Date.today.strftime("%B %Y") %>
          </p>
        </div>
        
        <!-- Money In Card - Swipeable to Income page -->
        <%= link_to income_events_path, class: "block bg-white/90 backdrop-blur-sm rounded-xl p-4 shadow-md border-2 border-green-300/60 hover:shadow-lg hover:bg-white transition-all active:scale-98" do %>
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm text-gray-600 mb-1">Money In</p>
              <p class="text-3xl font-bold text-gray-900"><%= number_to_currency(@total_income) %></p>
              <% if @expected_income > @total_income %>
                <p class="text-xs text-orange-600 mt-1">
                  Expected: <%= number_to_currency(@expected_income) %>
                </p>
              <% end %>
            </div>
            <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </div>
        <% end %>
        
        <!-- Spending Card - Swipeable to Expenses -->
        <%= link_to expenses_path, class: "block bg-white/90 backdrop-blur-sm rounded-xl p-4 shadow-md border-2 border-amber-300/60 hover:shadow-lg hover:bg-white transition-all active:scale-98" do %>
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm text-gray-600 mb-1">Spending</p>
              <p class="text-3xl font-bold text-gray-900"><%= number_to_currency(@total_spent) %></p>
            </div>
            <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </div>
        <% end %>
        
        <!-- Money Map Card - Link to unified view -->
        <%= link_to money_map_path, class: "block bg-white/90 backdrop-blur-sm rounded-xl p-4 shadow-md border-2 border-purple-300/60 hover:shadow-lg hover:bg-white transition-all active:scale-98" do %>
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm text-gray-600 mb-1">Money Map</p>
              <p class="text-lg font-bold text-gray-900">Complete Overview</p>
            </div>
            <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </div>
        <% end %>
      </div>
    <% end %>

    <!-- Admin Testing Section -->
    <% if current_user.admin? %>
      <div class="mt-6 pt-6 border-t-2 border-red-300">
        <div class="bg-red-50 rounded-xl p-4 shadow-md border-2 border-red-300">
          <h3 class="text-lg font-bold text-red-900 mb-3 text-center">⚠️ Testing Tools (Admin Only) ⚠️</h3>
          <p class="text-xs text-red-700 mb-4 text-center">Use these buttons to reset data for testing. This action cannot be undone!</p>
          
          <div class="space-y-3">
            <%= form_with url: clear_income_events_path, method: :post, 
                  data: { confirm: "⚠️ WARNING: This will permanently delete ALL income events. This action CANNOT be undone. Are you sure you want to proceed?" },
                  class: "w-full" do |f| %>
              <%= f.submit "Clear Income Events", 
                    class: "w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold px-4 py-3 rounded-lg transition-colors text-center min-h-[44px] inline-flex items-center justify-center cursor-pointer" %>
            <% end %>
            
            <%= form_with url: clear_expenses_path, method: :post,
                  data: { confirm: "⚠️ WARNING: This will permanently delete ALL expenses and their payments. This action CANNOT be undone. Are you sure you want to proceed?" },
                  class: "w-full" do |f| %>
              <%= f.submit "Clear Expenses", 
                    class: "w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold px-4 py-3 rounded-lg transition-colors text-center min-h-[44px] inline-flex items-center justify-center cursor-pointer" %>
            <% end %>
            
            <%= form_with url: reset_data_path, method: :post,
                  data: { confirm: "⚠️ WARNING: This will permanently delete ALL expenses, payments, monthly budgets, and income events. This action CANNOT be undone and you will lose all financial data. Are you absolutely sure you want to proceed?" },
                  class: "w-full" do |f| %>
              <%= f.submit "Reset All Data (Keep Templates)", 
                    class: "w-full bg-red-600 hover:bg-red-700 text-white font-semibold px-4 py-3 rounded-lg transition-colors text-center min-h-[44px] inline-flex items-center justify-center cursor-pointer" %>
            <% end %>
            
            <%= form_with url: reset_all_data_path, method: :post,
                  data: { confirm: "⚠️ CRITICAL WARNING: This will permanently delete EVERYTHING - all expenses, payments, monthly budgets, income events, AND all income/expense templates. This is a complete reset and CANNOT be undone. Are you absolutely certain you want to proceed?" },
                  class: "w-full" do |f| %>
              <%= f.submit "Reset Everything (Including Templates)", 
                    class: "w-full bg-red-800 hover:bg-red-900 text-white font-semibold px-4 py-3 rounded-lg transition-colors text-center min-h-[44px] inline-flex items-center justify-center cursor-pointer" %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
