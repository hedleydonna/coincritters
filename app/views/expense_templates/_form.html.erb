<%= form_with model: @template, local: true, class: "space-y-6 max-w-2xl bg-white shadow rounded-lg p-8" do |f| %>
  <%= hidden_field_tag :return_to, @return_to if @return_to.present? %>
  <% if @template.errors.any? %>
    <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
      <h3 class="text-red-800 font-semibold mb-2">
        <%= pluralize(@template.errors.count, "error") %> prevented this branch from being saved:
      </h3>
      <ul class="list-disc list-inside text-red-700 space-y-1">
        <% @template.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div>
    <%= f.label :name, "Template Name", class: "block text-sm font-medium text-gray-700 mb-2" %>
    <%= f.text_field :name, 
          class: "w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500", 
          placeholder: "e.g. Groceries, Rent, Netflix" %>
    <p class="mt-1 text-sm text-gray-500">A descriptive name for this expense template</p>
  </div>

  <div>
    <%= f.label :frequency, "Frequency", class: "block text-sm font-medium text-gray-700 mb-2" %>
    <%= f.select :frequency, 
          options_for_select([
            ["Monthly", "monthly"], 
            ["Weekly", "weekly"],
            ["Biweekly", "biweekly"],
            ["Yearly", "yearly"]
          ], @template.frequency || "monthly"),
          {}, 
          class: "w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
    <p class="mt-1 text-sm text-gray-500">How often this expense occurs</p>
  </div>

  <div>
    <%= f.label :due_date, "Due Date", class: "block text-sm font-medium text-gray-700 mb-2" %>
    <%= f.date_field :due_date, 
          class: "w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
    <p class="mt-1 text-sm text-gray-500">Optional: When this expense is typically due</p>
  </div>

  <div>
    <%= f.label :default_amount, "Default Amount", class: "block text-sm font-medium text-gray-700 mb-2" %>
    <div class="relative">
      <span class="absolute left-3 top-2 text-gray-500">$</span>
      <%= f.number_field :default_amount, 
            step: "0.01", 
            min: "0",
            class: "w-full border border-gray-300 rounded-lg px-4 py-2 pl-8 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
    </div>
    <p class="mt-1 text-sm text-gray-500">Optional: Set a default amount for this expense</p>
  </div>

  <div class="space-y-4">

    <div class="flex items-start gap-3">
      <%= f.check_box :auto_create, 
            { checked: @template.new_record? ? true : @template.auto_create? },
            class: "mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" %>
      <div>
        <%= f.label :auto_create, "Add this expense every month automatically", class: "text-sm font-medium text-gray-700 cursor-pointer" %>
        <p class="text-sm text-gray-500">When enabled, this template will automatically create expenses in new monthly budgets</p>
      </div>
    </div>
  </div>

  <div class="flex gap-4 pt-4">
    <%= f.submit @template.new_record? ? "Create Spending Item" : "Update Spending Item", 
          class: "bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium cursor-pointer" %>
    <%= link_to "Cancel", expense_templates_path(return_to: @return_to), 
          class: "bg-gray-200 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-300 transition-colors font-medium" %>
  </div>
<% end %>

