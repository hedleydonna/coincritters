<nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50 safe-area-inset-bottom md:hidden">
  <div class="flex justify-around items-center h-16 px-2">
    <!-- Home (Money Map) -->
    <%= link_to money_map_path, 
          class: "flex flex-col items-center justify-center flex-1 h-full min-h-[44px] #{current_page?(money_map_path) ? 'text-purple-600' : 'text-gray-600 hover:text-gray-900'}" do %>
      <svg class="w-5 h-5 mb-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
      </svg>
      <span class="text-[10px] font-medium">Home</span>
    <% end %>

    <!-- Money In -->
    <%= link_to income_events_path, 
          class: "flex flex-col items-center justify-center flex-1 h-full min-h-[44px] #{current_page?(income_events_path) || request.path.start_with?('/income_events') ? 'text-green-600' : 'text-gray-600 hover:text-gray-900'}" do %>
      <svg class="w-5 h-5 mb-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <span class="text-[10px] font-medium">Money In</span>
    <% end %>

    <!-- Spending -->
    <%= link_to expenses_path, 
          class: "flex flex-col items-center justify-center flex-1 h-full min-h-[44px] #{current_page?(expenses_path) || request.path.start_with?('/expenses') ? 'text-red-600' : 'text-gray-600 hover:text-gray-900'}" do %>
      <svg class="w-5 h-5 mb-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z" />
      </svg>
      <span class="text-[10px] font-medium">Spending</span>
    <% end %>

    <!-- More Menu -->
    <div class="flex flex-col items-center justify-center flex-1 h-full min-h-[44px] relative" data-controller="dropdown">
      <button 
        type="button"
        data-action="click->dropdown#toggle"
        data-dropdown-target="button"
        class="flex flex-col items-center justify-center text-gray-600 hover:text-gray-900"
        aria-label="More"
      >
        <!-- Three dots icon (More) -->
        <svg data-dropdown-target="moreIcon" class="w-5 h-5 mb-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />
        </svg>
        <!-- X icon (Close) -->
        <svg data-dropdown-target="closeIcon" class="w-5 h-5 mb-0.5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
        <span data-dropdown-target="label" class="text-[10px] font-medium">More</span>
      </button>

      <!-- Dropdown Menu -->
      <div 
        data-dropdown-target="menu"
        class="hidden absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-64 bg-white rounded-lg shadow-xl border border-gray-200 py-2 z-50"
      >
        <!-- Admin Section -->
        <% if current_user.admin? %>
          <div class="px-4 py-2 border-b border-gray-200">
            <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Admin Tools</p>
          </div>
          
          <div class="py-1">
            <%= form_with url: clear_income_events_path, method: :post, 
                  data: { turbo: true, confirm: "⚠️ WARNING: This will permanently delete ALL income events. This action CANNOT be undone. Are you sure you want to proceed?" },
                  class: "w-full" do |f| %>
              <%= f.submit "Clear Income Events", 
                    class: "w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors cursor-pointer" %>
            <% end %>
            
            <%= form_with url: clear_expenses_path, method: :post,
                  data: { turbo: true, confirm: "⚠️ WARNING: This will permanently delete ALL expenses and their payments. This action CANNOT be undone. Are you sure you want to proceed?" },
                  class: "w-full" do |f| %>
              <%= f.submit "Clear Expenses", 
                    class: "w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors cursor-pointer" %>
            <% end %>
            
            <%= form_with url: reset_data_path, method: :post,
                  data: { turbo: true, confirm: "⚠️ WARNING: This will permanently delete ALL expenses, payments, monthly budgets, and income events. This action CANNOT be undone and you will lose all financial data. Are you absolutely sure you want to proceed?" },
                  class: "w-full" do |f| %>
              <%= f.submit "Reset All Data (Keep Templates)", 
                    class: "w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors cursor-pointer" %>
            <% end %>
            
            <%= form_with url: reset_all_data_path, method: :post,
                  data: { turbo: true, confirm: "⚠️ CRITICAL WARNING: This will permanently delete EVERYTHING - all expenses, payments, monthly budgets, income events, AND all income/expense templates. This is a complete reset and CANNOT be undone. Are you absolutely certain you want to proceed?" },
                  class: "w-full" do |f| %>
              <%= f.submit "Reset Everything (Including Templates)", 
                    class: "w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50 transition-colors cursor-pointer" %>
            <% end %>
          </div>
          
          <div class="px-4 py-2 border-t border-gray-200"></div>
        <% end %>

        <!-- Templates Section -->
        <div class="py-1">
          <%= link_to income_templates_path, 
                class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors" do %>
            Income Templates
          <% end %>
          
          <%= link_to expense_templates_path, 
                class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors" do %>
            Expense Templates
          <% end %>
        </div>

        <div class="px-4 py-2 border-t border-gray-200"></div>

        <!-- Settings & Logout -->
        <div class="py-1">
          <%= link_to settings_path, 
                class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors" do %>
            Settings
          <% end %>
          
          <%= button_to destroy_user_session_path, method: :delete,
                class: "w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors cursor-pointer",
                form: { class: "w-full", data: { turbo: true } } do %>
            Log Out
          <% end %>
        </div>
      </div>
    </div>
  </div>
</nav>

