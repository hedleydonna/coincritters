<div class="fixed top-4 left-4 z-50" data-controller="dropdown">
  <!-- Menu Button -->
  <button 
    type="button"
    data-action="click->dropdown#toggle"
    data-dropdown-target="button"
    class="bg-white rounded-full p-3 shadow-lg border border-gray-200 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
    aria-label="Menu"
  >
    <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
    </svg>
  </button>

  <!-- Dropdown Menu -->
  <div 
    data-dropdown-target="menu"
    class="hidden absolute top-14 left-0 w-64 bg-white rounded-lg shadow-xl border border-gray-200 py-2 z-50"
  >
    <!-- Admin Section -->
    <% if current_user.admin? %>
      <div class="px-4 py-2 border-b border-gray-200">
        <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Admin Tools</p>
      </div>
      
      <div class="py-1">
        <%= form_with url: clear_income_events_path, method: :post, 
              data: { turbo: true, confirm: "⚠️ WARNING: This will permanently delete ALL income events. This action CANNOT be undone. Are you sure you want to proceed?" },
              class: "w-full" do |f| %>
          <%= f.submit "Clear Income Events", 
                class: "w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors cursor-pointer" %>
        <% end %>
        
        <%= form_with url: clear_expenses_path, method: :post,
              data: { turbo: true, confirm: "⚠️ WARNING: This will permanently delete ALL expenses and their payments. This action CANNOT be undone. Are you sure you want to proceed?" },
              class: "w-full" do |f| %>
          <%= f.submit "Clear Expenses", 
                class: "w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors cursor-pointer" %>
        <% end %>
        
        <%= form_with url: reset_data_path, method: :post,
              data: { turbo: true, confirm: "⚠️ WARNING: This will permanently delete ALL expenses, payments, monthly budgets, and income events. This action CANNOT be undone and you will lose all financial data. Are you absolutely sure you want to proceed?" },
              class: "w-full" do |f| %>
          <%= f.submit "Reset All Data (Keep Templates)", 
                class: "w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors cursor-pointer" %>
        <% end %>
        
        <%= form_with url: reset_all_data_path, method: :post,
              data: { turbo: true, confirm: "⚠️ CRITICAL WARNING: This will permanently delete EVERYTHING - all expenses, payments, monthly budgets, income events, AND all income/expense templates. This is a complete reset and CANNOT be undone. Are you absolutely certain you want to proceed?" },
              class: "w-full" do |f| %>
          <%= f.submit "Reset Everything (Including Templates)", 
                class: "w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50 transition-colors cursor-pointer" %>
        <% end %>
      </div>
      
      <div class="px-4 py-2 border-t border-gray-200"></div>
    <% end %>

    <!-- Templates Section -->
    <div class="py-1">
      <%= link_to income_templates_path, 
            class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors" do %>
        Income Templates
      <% end %>
      
      <%= link_to expense_templates_path, 
            class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors" do %>
        Expense Templates
      <% end %>
    </div>

    <div class="px-4 py-2 border-t border-gray-200"></div>

    <!-- Settings & Logout -->
    <div class="py-1">
      <%= link_to settings_path, 
            class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors" do %>
        Settings
      <% end %>
      
      <%= button_to destroy_user_session_path, method: :delete,
            class: "w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors cursor-pointer",
            form: { class: "w-full", data: { turbo: true } } do %>
        Log Out
      <% end %>
    </div>
  </div>
</div>

